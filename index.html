<!DOCTYPE html>
<html>
<head>
    <title>PureCrunchEats - Order & Pay</title>
    <style>
        body { font-family: Arial; max-width: 800px; margin: 0 auto; padding: 20px; }
        .menu-item { border: 1px solid #ddd; padding: 15px; margin-bottom: 15px; border-radius: 8px; }
        .menu-item img { width: 100%; height: 200px; object-fit: cover; border-radius: 5px; }
        button { background: #e74c3c; color: white; border: none; padding: 10px 15px; border-radius: 5px; cursor: pointer; }
        #cart { background: #f9f9f9; padding: 20px; margin-top: 30px; border-radius: 8px; }
        #payment-form { display: none; margin-top: 20px; }
        input, textarea, select { 
            width: 100%; padding: 10px; margin: 8px 0 15px; 
            box-sizing: border-box; border: 1px solid #ddd; border-radius: 4px; 
        }
        .promo-banner { width: 100%; border-radius: 8px; margin: 20px 0; }
        h1 { color: #e74c3c; text-align: center; }
        h2 { border-bottom: 2px solid #e74c3c; padding-bottom: 5px; }
        .menu-category { margin-top: 30px; }
        .form-row { display: flex; gap: 15px; }
        .form-row > div { flex: 1; }
        .processing { background: #27ae60 !important; }
    </style>
</head>
<body>
    <h1>PureCrunchEats</h1>
    <img src="promo-banner.jpg" alt="Special Offers" class="promo-banner">

    <div class="menu-category">
        <h2>Smoothies</h2>
        <div class="menu">
            <div class="menu-item">
                <img src="smoothie-menu.jpg" alt="Strawberry Bliss">
                <h3>STRAWBERRY BLISS - R32.00</h3>
                <p>Fresh strawberries, banana, Greek yogurt, honey</p>
                <button class="add-to-cart" data-name="STRAWBERRY BLISS" data-price="32">Add to Cart</button>
            </div>
            
            <div class="menu-item">
                <img src="smoothie-menu.jpg" alt="Blueberry Burst">
                <h3>BLUEBERRY BURST - R35.00</h3>
                <p>Blueberries, banana, almond milk, chia seeds</p>
                <button class="add-to-cart" data-name="BLUEBERRY BURST" data-price="35">Add to Cart</button>
            </div>
            
            <div class="menu-item">
                <img src="smoothie-menu.jpg" alt="Tropical Sunset">
                <h3>TROPICAL SUNSET - R36.00</h3>
                <p>Mango, pineapple, orange juice, coconut</p>
                <button class="add-to-cart" data-name="TROPICAL SUNSET" data-price="36">Add to Cart</button>
            </div>
            
            <div class="menu-item">
                <img src="smoothie-menu.jpg" alt="Green Energy">
                <h3>GREEN ENERGY - R34.00</h3>
                <p>Spinach, kale, apple, banana, ginger</p>
                <button class="add-to-cart" data-name="GREEN ENERGY" data-price="34">Add to Cart</button>
            </div>
        </div>
    </div>

    <div class="menu-category">
        <h2>Chicken & Fries</h2>
        <div class="menu">
            <div class="menu-item">
                <img src="wing-fries.jpg" alt="Crispy Wing">
                <h3>1 CRISPY WING - R8.00</h3>
                <p>Juicy chicken wing with secret spices</p>
                <button class="add-to-cart" data-name="1 CRISPY WING" data-price="8">Add to Cart</button>
            </div>
            
            <div class="menu-item">
                <img src="wing-fries.jpg" alt="Wing Combo">
                <h3>4 WINGS + FRIES - R40.00</h3>
                <p>4 wings with small fries and sauce</p>
                <button class="add-to-cart" data-name="4 WINGS + FRIES" data-price="40">Add to Cart</button>
            </div>
            
            <div class="menu-item">
                <img src="wing-fries.jpg" alt="Fries">
                <h3>FRIES WITH SAUCE - R13.00</h3>
                <p>Crispy fries with dipping sauce</p>
                <button class="add-to-cart" data-name="FRIES WITH SAUCE" data-price="13">Add to Cart</button>
            </div>
        </div>
    </div>

    <div id="cart">
        <h2>Your Order</h2>
        <div id="cart-items"></div>
        <div id="cart-total">Total: R0.00</div>
        <button id="checkout-btn">Checkout</button>
    </div>

    <div id="payment-form">
        <h2>Complete Order</h2>
        <input type="text" id="name" placeholder="Full Name" required>
        <input type="tel" id="phone" placeholder="Phone Number" required>
        
        <div>
            <input type="radio" name="delivery" id="collection" checked>
            <label for="collection">Collection</label>
            <input type="radio" name="delivery" id="delivery">
            <label for="delivery">Delivery (+R3)</label>
        </div>
        
        <textarea id="address" placeholder="Delivery Address" style="display:none;"></textarea>
        
        <h3>Payment Details</h3>
        <select id="card-type" required>
            <option value="">Select Card Type</option>
            <option value="visa">Visa</option>
            <option value="mastercard">Mastercard</option>
            <option value="amex">American Express</option>
        </select>
        
        <input type="text" id="card-number" placeholder="Card Number (16 digits)" required maxlength="16">
        
        <div class="form-row">
            <div>
                <input type="text" id="expiry" placeholder="MM/YY" required maxlength="5">
            </div>
            <div>
                <input type="text" id="cvv" placeholder="CVV" required maxlength="4">
            </div>
        </div>
        
        <button id="pay-now">Pay Now</button>
        <button id="cancel-payment" type="button">Cancel</button>
    </div>

    <div id="success" style="display:none;">
        <h2>Payment Successful! 🎉</h2>
        <p>We've deducted the payment from your account</p>
        <p>WhatsApp notification sent to 0731575601</p>
        <div id="order-summary"></div>
        <button id="new-order">Place New Order</button>
    </div>

    <script>
        const cart = [];
        const DELIVERY_FEE = 3;
        const OWNER_PHONE = '0731575601';
        
        // Cart functions
        function updateCart() {
            const itemsEl = document.getElementById('cart-items');
            const totalEl = document.getElementById('cart-total');
            
            if (cart.length === 0) {
                itemsEl.innerHTML = '<p>Cart is empty</p>';
                totalEl.textContent = 'Total: R0.00';
                return;
            }
            
            let html = '';
            let subtotal = 0;
            
            cart.forEach((item, index) => {
                const itemTotal = item.price * item.quantity;
                subtotal += itemTotal;
                html += `
                    <div style="margin: 10px 0; display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            ${item.name} 
                            <button onclick="updateQuantity(${index}, -1)" style="padding: 2px 8px;">-</button>
                            ${item.quantity}
                            <button onclick="updateQuantity(${index}, 1)" style="padding: 2px 8px;">+</button>
                        </div>
                        <div>R${itemTotal.toFixed(2)}</div>
                    </div>
                `;
            });
            
            const delivery = document.getElementById('delivery').checked ? DELIVERY_FEE : 0;
            const total = subtotal + delivery;
            
            if (delivery > 0) {
                html += `
                    <div style="margin: 10px 0; display: flex; justify-content: space-between;">
                        <div>Delivery Fee</div>
                        <div>R${DELIVERY_FEE.toFixed(2)}</div>
                    </div>
                `;
            }
            
            itemsEl.innerHTML = html;
            totalEl.textContent = `Total: R${total.toFixed(2)}`;
        }
        
        function addItem(name, price) {
            const existing = cart.find(item => item.name === name);
            if (existing) existing.quantity++;
            else cart.push({ name, price, quantity: 1 });
            updateCart();
        }
        
        function updateQuantity(index, change) {
            cart[index].quantity += change;
            if (cart[index].quantity < 1) cart.splice(index, 1);
            updateCart();
        }

        // Event listeners
        document.querySelectorAll('.add-to-cart').forEach(btn => {
            btn.addEventListener('click', () => addItem(btn.dataset.name, parseFloat(btn.dataset.price)));
        });
        
        document.getElementById('checkout-btn').addEventListener('click', () => {
            if (cart.length === 0) return alert('Your cart is empty');
            document.getElementById('payment-form').style.display = 'block';
        });
        
        document.querySelectorAll('input[name="delivery"]').forEach(radio => {
            radio.addEventListener('change', () => {
                document.getElementById('address').style.display = 
                    document.getElementById('delivery').checked ? 'block' : 'none';
                updateCart();
            });
        });
        
        document.getElementById('pay-now').addEventListener('click', processPayment);
        document.getElementById('cancel-payment').addEventListener('click', () => {
            document.getElementById('payment-form').style.display = 'none';
        });
        document.getElementById('new-order').addEventListener('click', () => {
            document.getElementById('success').style.display = 'none';
            document.getElementById('payment-form').reset();
            document.getElementById('address').style.display = 'none';
        });

        // Format expiry date input
        document.getElementById('expiry').addEventListener('input', function(e) {
            if (this.value.length === 2 && !this.value.includes('/')) {
                this.value = this.value + '/';
            }
        });

        async function processPayment() {
            const payBtn = document.getElementById('pay-now');
            const name = document.getElementById('name').value.trim();
            const phone = document.getElementById('phone').value.trim();
            const cardType = document.getElementById('card-type').value;
            const cardNumber = document.getElementById('card-number').value.trim();
            const expiry = document.getElementById('expiry').value.trim();
            const cvv = document.getElementById('cvv').value.trim();
            const address = document.getElementById('address').value.trim();
            
            // Validate inputs
            if (!name || !phone) return alert('Please enter your name and phone number');
            if (!cardType) return alert('Please select card type');
            if (cardNumber.length !== 16) return alert('Card number must be 16 digits');
            if (!expiry.match(/^\d{2}\/\d{2}$/)) return alert('Enter expiry date in MM/YY format');
            if (cvv.length < 3 || cvv.length > 4) return alert('CVV must be 3 or 4 digits');
            if (document.getElementById('delivery').checked && !address) {
                return alert('Please enter delivery address');
            }
            
            // Calculate total
            const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const total = subtotal + (document.getElementById('delivery').checked ? DELIVERY_FEE : 0);
            
            // Show processing
            payBtn.disabled = true;
            payBtn.classList.add('processing');
            payBtn.textContent = 'Processing Payment...';
            
            // Simulate payment processing (2 seconds)
            await new Promise(resolve => setTimeout(resolve, 2000));
            
            // Create order summary
            let summary = `💳 PAYMENT RECEIVED: R${total.toFixed(2)}\n`;
            summary += `👤 Customer: ${name}\n📞 Phone: ${phone}\n\n`;
            summary += `🍽️ ORDER DETAILS:\n`;
            cart.forEach(item => summary += `- ${item.name} x${item.quantity} - R${(item.price * item.quantity).toFixed(2)}\n`);
            summary += `\n💰 Subtotal: R${subtotal.toFixed(2)}\n`;
            if (document.getElementById('delivery').checked) {
                summary += `🚚 Delivery Fee: R${DELIVERY_FEE.toFixed(2)}\n`;
            }
            summary += `💵 TOTAL PAID: R${total.toFixed(2)}\n\n`;
            summary += document.getElementById('delivery').checked ? 
                `📍 DELIVERY ADDRESS:\n${address}` : '🛒 COLLECTION';
            
            // Show success
            document.getElementById('payment-form').style.display = 'none';
            document.getElementById('success').style.display = 'block';
            document.getElementById('order-summary').innerHTML = summary.replace(/\n/g, '<br>');
            
            // Log payment details (simulated)
            console.log('💳 Payment processed from card:', cardNumber.slice(-4));
            console.log('📲 WhatsApp notification sent to:', OWNER_PHONE);
            console.log('📋 Order details:\n', summary);
            
            // In a real app, you would:
            // 1. Connect to payment gateway API
            // 2. Actually deduct money from customer's account
            // 3. Send WhatsApp via API (not just console.log)
            
            // Clear cart
            cart.length = 0;
            updateCart();
            payBtn.disabled = false;
            payBtn.classList.remove('processing');
            payBtn.textContent = 'Pay Now';
        }
    </script>
</body>
</html>
